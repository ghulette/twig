-- C stuff
ccall = [<cfunc(Ret,Args),Args> -> Ret : "ccall"]

-- Java stuff
jentry(s) = [X -> jmethod(X,X)];
  { [cfunc(Ret,Args) -> <cfunc(Ret,Args),Args>]; #2(#all(wrap));s
  , [cfunc(Ret,Args) -> Args]; #all(wrap)
  }

-- Convert C to Java
r1   = [cptr(cchar) -> jstring : "r1"]
r2   = [cint -> jint : "r2"]
wrap = r1 | r2

-- Convert Java to C
r3 = [jstring -> cptr(cchar) : "r3"]
r4 = [jint -> cint : "r4"]
unwrap = r3 | r4

main = jentry({T,{unwrap,unwrap}};ccall;wrap)
