lt(zero, s(X)) -> true
lt(s(X), zero) -> false
lt(s(X), s(Y)) -> lt(X, Y)

append(nil, Y) -> Y
append(add(N, X), Y) -> add(N, append(X, Y))

split(N, nil) -> pair(nil, nil)
split(N, add(M, Y)) -> f1(split(N, Y), N, M, Y)

f1(pair(X, Z), N, M, Y) -> f2(lt(N, M), N, M, Y, X, Z)
f2(true, N, M, Y, X, Z) -> pair(X, add(M, Z))
f2(false, N, M, Y, X, Z) -> pair(add(M, X), Z)

qsort(nil) -> nil
qsort(add(N, X)) -> f3(split(N, X), N, X)

f3(pair(Y, Z), N, X) -> append(qsort(Y), add(X, qsort(Z)))
